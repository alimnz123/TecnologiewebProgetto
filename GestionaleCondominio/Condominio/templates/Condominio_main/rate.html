{% extends 'Condominio_main/base.html' %}
{% block title %}Rate{% endblock %}
{% block content %} 
<h1>Rate</h1>

{% comment %}MESSAGES{% endcomment %}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>
        {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
        <div class="alert alert-danger" role="alert">
          {{ message }}  
        </div>

        {% else %}

        <div class="alert alert-success" role="alert">
          {{ message }}  
        </div>

        {% endif %}
        
    </li>
    {% endfor %}
</ul>
{% endif %}

{% comment  %} solo se sei un amministratore {% endcomment %}
<a class="btn btn-primary" href="/create_rata" role="button">Aggiungi una Rata</a>

{% comment %}Rate{% endcomment %}
<table class="table">
    <thead>
      <tr>
        <th scope="col">Data_scadenza</th>
        <th scope="col">Descrizione</th>
        <th scope="col">Importo</th>
        <th scope="col">Pagata</th>
        <th scope="col">Operazioni</th>
      </tr>
    </thead>
    <tbody>
        {% for rata in rate %}
        <tr>
            <th scope="row">{{rata.data_scadenza}}</th>
            <td>{{rata.descrizione}}</td>
            <td>{{rata.importo}} â‚¬</td>
            <td>{{spesa.pagata}}</td>
            <td>
                {% if user == rata.author or perms.main.delete_rata %}
                <form method="post">
                        {% csrf_token %}
                        <a href="{% url 'cancella_rata' pk=rata.pk %}" class="btn btn-danger">Cancella Rata</a>
                        {% comment %}
                        ELIMINA CON FBV
                          <button type="submit" class="btn btn-danger" name="spesa-id" value="{{spesa.id}}">Elimina</button>
                        {% endcomment %}
                </form>
                <form method="post">
                        {% csrf_token %}
                        <a href="{% url 'edit_rata' pk=rata.pk %}" class="btn btn-link">Modifica</a>
                </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}